<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Document</title>
    <link href="/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="css/public.css" />
    <link rel="stylesheet" type="text/css" href="css/css.css" />
    <script src="js/jquery-1.12.3.min.js"></script>
    <script type="text/javascript" src="js/public.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <style>
        .container{
            width: 15%;
            height: 600px;
            float: left;
        }
        .container dl{
            margin-bottom: 0;
        }
        .right{
            width:85%;
            height:600px;
            float:right;
            overflow-y: scroll;
        }
        .page{
            padding-left: 50px;
        }
        .leftsidebar_box{
            width: 100%;
        }
        .cont{
            padding: 30px;
        }
        h4 {
            font-size: 25px;
            color: #4390b9;
            font-weight:bold;
            line-height: 200%;
        }
        .cont p{
            line-height: 200%;
            margin: 10px 0;
        }
        input[type=date]{
            line-height: 100%;
        }
    </style>
</head>
<body>
<div class="head">
    <div class="headL">
        酒店管理系统
    </div>
    <div class="headR">
        <p class="p1">
            欢迎,<%=username%>
        </p>
        <p class="p2">
            <a href="#" class="resetPWD">重置密码</a>&nbsp;&nbsp;
            <a href="/" class="goOut">退出</a>
        </p>
    </div>
    <!-- onclick="{if(confirm(&quot;确定退出吗&quot;)){return true;}return false;}" -->
</div>
<div class="closeOut">
    <div class="coDiv">
        <p class="p1">
            <span>X</span>
        </p>
        <p class="p2">确定退出当前用户？</p>
        <P class="p3">
            <a class="ok yes" href="#">确定</a><a class="ok no" href="#">取消</a>
        </p>
    </div>
</div>
<div class="bodys">
    <!--左边-->
    <div class="container">
        <div class="leftsidebar_box">
            <a href="/" ><div class="line">
                    <img src="../img/coin01.png" />&nbsp;&nbsp;首页
                </div></a>
            <!-- <dl class="system_log">
            <dt><img class="icon1" src="../img/coin01.png" /><img class="icon2"src="../img/coin02.png" />
                首页<img class="icon3" src="../img/coin19.png" /><img class="icon4" src="../img/coin20.png" /></dt>
        </dl> -->
            <dl class="system_log">
                <dt>
                    <img class="icon1" src="../img/coin03.png" />
                    <img class="icon2" src="../img/coin04.png" />
                    入住管理
                    <img class="icon3" src="../img/coin19.png" />
                    <img class="icon4" src="../img/coin20.png" />
                </dt>
                <dd>
                    <img class="coin11" src="../img/coin111.png" />
                    <img class="coin22" src="../img/coin222.png" />
                    <a class="cks" href="/datang" >大堂入住</a>
                    <img class="icon5" src="../img/coin21.png" />
                </dd>
                <dd>
                    <img class="coin11" src="../img/coin111.png" />
                    <img class="coin22" src="../img/coin222.png" />
                    <a class="cks" href="/dingdianruzhu" >
                        订单入住</a>
                    <img class="icon5" src="../img/coin21.png" />
                </dd>
            </dl>
            <dl class="system_log">
                <dt>
                    <img class="icon1" src="../img/coin05.png" />
                    <img class="icon2" src="../img/coin06.png" />
                    退房管理
                    <img class="icon3" src="../img/coin19.png" />
                    <img class="icon4" src="../img/coin20.png" />
                </dt>
                <dd>
                    <img class="coin11" src="../img/coin111.png" />
                    <img class="coin22" src="../img/coin222.png" />
                    <a class="cks" href="/checkroom">退房管理</a>
                    <img class="icon5" src="../img/coin21.png" />
                </dd>
            </dl>
            <dl class="system_log">
                <dt>
                    <img class="icon1" src="../img/coin07.png" />
                    <img class="icon2" src="../img/coin08.png" /> 记录查询
                    <img class="icon3" src="../img/coin19.png" />
                    <img class="icon4" src="../img/coin20.png" />
                </dt>
                <dd>
                    <img class="coin11" src="../img/coin111.png" />
                    <img class="coin22" src="../img/coin222.png" />
                    <a href="/showRecord" class="cks">入住记录查询</a>
                    <img class="icon5" src="../img/coin21.png" />
                </dd>
            </dl>
            <dl class="system_log">
                <dt>
                    <img class="icon1" src="../img/coin10.png" />
                    <img class="icon2" src="../img/coin09.png" /> 房间管理
                    <img class="icon3" src="../img/coin19.png" />
                    <img class="icon4" src="../img/coin20.png" />
                </dt>
                <dd>
                    <img class="coin11" src="../img/coin111.png" />
                    <img class="coin22" src="../img/coin222.png" />
                    <a href="/RoomAmount" class="cks">房间管理</a>
                    <img class="icon5" src="../img/coin21.png" />
                </dd>
                <dd>
                    <img class="coin11" src="../img/coin111.png" />
                    <img class="coin22" src="../img/coin222.png" />
                    <a href="/fang" class="cks">房间状态</a>
                    <img class="icon5" src="../img/coin21.png" />
                </dd>

            </dl>
            <dl class="system_log">
                <dt>
                    <img class="icon1" src="../img/coin11.png" />
                    <img class="icon2" src="../img/coin12.png" />
                    房类管理
                    <img class="icon3" src="../img/coin19.png" />
                    <img class="icon4" src="../img/coin20.png" />
                </dt>
                <dd>
                    <img class="coin11" src="../img/coin111.png" />
                    <img class="coin22" src="../img/coin222.png" />
                    <a href="/Room"  class="cks">房间类别管理</a>
                    <img class="icon5" src="../img/coin21.png" />
                </dd>
            </dl>
            <dl class="system_log">
                <dt>
                    <img class="icon1" src="../img/coin14.png" />
                    <img class="icon2" src="../img/coin13.png" /> 修改密码
                    <img class="icon3" src="../img/coin19.png" />
                    <img class="icon4" src="../img/coin20.png" />
                </dt>
                <dd>
                    <img class="coin11" src="../img/coin111.png" />
                    <img class="coin22" src="../img/coin222.png" />
                    <a href="/updatemima"  class="cks">修改密码</a>
                    <img class="icon5" src="../img/coin21.png" />
                </dd>
            </dl>

        </div>
    </div>
    <!--右边-->
    <div class="right">
        <div class="pageTop">
            <div class="page">
                <img src="../img/coin02.png" /><span><a href="#">首页</a>&nbsp;-&nbsp;<a
                            href="#">公共管理</a>&nbsp;-</span>&nbsp;意见管理
            </div>
        </div>

        <div class="cont">
            <h4>顾客信息</h4>
            <p>

                    入住时间: <input name="" class="comeday" type="date">


                    离开时间: <input class="goday" type="date">

            </p>
            <p>
                <span>
                    证件类型:
                    <select name="" id="" class="zhengjian">
                        <option value="身份证">身份证</option>
                        <option value="驾驶证">驾驶证</option>
                    </select>
                </span>
                <span>
                    证件号: <input class="zhengjianhao" type="text">
                </span>
            </p>
            <p>
                    <span>
                        姓名: <input class="rename" type="text">
                    </span>
                <span>
                        性别:
                                <select name="" class="sex">
                                    <option value="男">男</option>
                                    <option value="女">女</option>
                                </select>
                    </span>
            </p>
            <h4 class="fxx">房间信息</h4>
            <p>
                <span>
                    房间类型: <select class="select" name="leixing" id=""></select>
                </span>
                <span>
                    房间号: <select name="text" class="fangjian"></select>
                </span>
            </p>
            <p>
                房间剩余数量: <span class="shengyu"></span>
            </p>
            <p>
                价格: <span class="jiage"></span>
            </p>
            <p>
                入住人姓名: <input class="name" type="text">
            </p>
            <p>
                <input type="button" class="btn" value="办理入住">
            </p>
        </div>
    </div>
</div>
<script>
    //房间类别
    $.get("/leibief",function(data){

        var str="";
        var datas=data.result;
        for(var i=0;i<datas.length;i++){
            str="<option>"+datas[i].CategoryName+"</option>";
            $(".select").append(str);
        }
    })

    //房间号
    $(".select").click(function () {
        var typename=$(this).val();
        $.get("/fanghao",function(data){

            $(".fangjian").empty();
            var str="";
            var data=data.result;
            var num=0;
            $.each(data, function (i, n) {

                console.log(n.RCategory);
                if(n.RCategory==typename&&n.RoomStatus=="未入住"){
                    num++;
                    str="<option>"+data[i].RID+"</option>";
                    $(".fangjian").append(str);
                }
            })
            $(".shengyu").html(num);
        })
    })

    //价格
    $(".fangjian").click(function () {
        var typename=$(".select").val();
        console.log()
        $.get("/jiagef",function(data){
            var data=data.result;
            console.log(data);
            $.each(data, function (i, n) {
                console.log(n);
                if(n.CategoryName==typename){
                    $(".jiage").html(data[i].Price)
                }
            })
        })
    })

    //办理入住
    $(".btn").click(function () {
        var comeday=$(".comeday").val();   // 入住时间
        var goday=$(".goday").val();      // 结束时间
        var starttime= comeday.split("-")[2];   // 获取时间值
        var endtime  = goday.split("-")[2];   // 获取时间值
        var time=endtime-starttime;    //  入住 几天
        console.log(time)
        console.log(comeday)
        $.post("/ruzhu", {
            "sid":$(".fangjian").val(),
            "comeday": comeday,
            "goday": goday,
            "name": $(".name").val(),
            "rename":$(".rename").val(),
            "zhengjianhao": $(".zhengjianhao").val(),
            "sex": $(".sex").val(),
            "fanghao": $(".fangjian").val(),
            "leixing": $(".select").val(),
            "zhuangtai":"已入住",
            "xiaofei": $(".jiage").html()*time,
            "zjleixing":$(".zhengjian").val(),
            "riqi":time,
            "jiage":$(".jiage").html()
        }, function (data) {
            if (data.result == 1) {
                alert("提交成功！");
                success();
                window.location.href = '/datang';

            } else if (data.result == -1) {
                alert("提交失败,被占用！");
            } else if (data.result == -2) {
                alert("服务器错误！请联系管理员，怎么联系我也不知道！");
            }
        })
    });
    //更改房号信息
    $(".btn").click(function () {

    });

    function success(){
        var sid=$(".fangjian").val();
        console.log(sid);
        var zhuangtai="已入住";
        console.log(zhuangtai);
        $.post("/fanghaotype/" + sid,{
            zhuangtai: zhuangtai
        },function(data){
            if(data.result == 1){

            }else{
                alert("服务器错误！请联系管理员，怎么联系我也不知道！");
            }
        })
    }
</script>
</body>
</html>